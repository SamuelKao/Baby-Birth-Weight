---
title: "HW1"
output: html_document
date: "2024-10-05"
---

# Header

1. Introduction
Our objective is to study the difference in weight between babies born to mothers who smoked during pregnancy and those who did not. We aim to determine whether this difference is significant for the health of the baby

## Check the variables type:
```{r}
df <- read.table(file = "babies.txt", header = TRUE)
df
```
Check the variable type

```{r}
type <- str(df)
```
Summary of variable:
```{r}
summary(df)
bwt_description="Numerical, Min:55.0, Median 120.0, Max: 176.0, Mean: 119.6"
gestation_description = "Numerical, Min: 148.0, Median: 280.0, Max: 999.0, Mean: 286.9"
parity_description = "Categorical (ordinal), Min: 0, Median:0, Max: 1.0000, Mean: 0.2549"
age_description = "Numerical, Min: 15.00, Median: 26.00, Max: 99.00, Mean: 27.37"
height_description = "Numerical, Min: 53.00, Median: 64.00, Max: 99.00, Mean: 64.67"
weight_description = "Numerical, Min: 87, Median: 126, Max:999, Mean: 154"
smoke_description = "Categorical, Min: 0, Median: 0, Max: 9.0, Mean: 0.4644"
```

Histogram of each variables:
```{r}
hist(df$bwt, main = 'Histogram of bwt',xlab = 'weight',freq=FALSE)
hist(df$gestation, main = 'Histogram of gestation',xlab = 'gestation',breaks =15,
,freq=FALSE)
hist(df$parity,main = 'Parity', freq=FALSE)
hist(df$age,main = 'Age', freq=FALSE, xlab='age')
hist(df$height,main = 'Height', freq=FALSE, xlab='Inches')
hist(df$weight,main = 'Weight', freq=FALSE, xlab='Pounds')
hist(df$smoke,main = 'smoke', freq=FALSE, xlab='0(no smoke) 1(smoke)', breaks = 20)



```



1b. 
Catch inconsistence, remove outliers, and null value.
```{r}
find_outliers_IQR <- function(column) {
  Q1 <- quantile(column, 0.25)
  Q3 <- quantile(column, 0.75)
  IQR_value <- IQR(column)
  
  lower_bound <- Q1 - 1.5 * IQR_value
  upper_bound <- Q3 + 1.5 * IQR_value
  
  return (column[column<lower_bound | column > upper_bound])
}

#
outliers <- lapply(df, find_outliers_IQR)


```
There is some extreme and error values that need to be removed. We need to remove all the values besides 0 and 1 in smoke value. It is not possible that a person is 99 inches tall or weight 999 pounds.

```{r}
#remove extreme values
clean_smoke <- df[df$smoke == 0 | df$smoke == 1,]
clean_weight<- clean_smoke[clean_smoke$weight < 300,]
clean_height <- clean_weight[clean_weight$height < 90,]
df_clean <- clean_height[clean_height$gestation < 365,]
df_clean
```

```{r}

summary(df_clean)
```

1C. This dataset qualifies SRS because the data is large enough, and every data could be selected.

2a. 
```{r}
aggregate(bwt ~ smoke, df_clean, min)
aggregate(bwt ~ smoke, df_clean, max)
smoker_min_bwt = 78
smoker_max_bwt = 163

nonsmoker_min_bwt = 78
nonsmoker_max_bwt = 164

aggregate(bwt ~ smoke, df_clean, mean)

nonsmoker_mean_bwt = 123.4241
smoker_mean_bwt = 115.2343

aggregate(bwt ~ smoke, df_clean, median)

nonsmoker_median_bwt = 124
smoker_median_bwt = 115


aggregate(bwt ~ smoke, df_clean, function(x) quantile(x, 0.25))
smoker_q1_bwt = 103
nonsmoker_q1_bwt = 113

aggregate(bwt ~ smoke, df_clean, function(x) quantile(x, 0.5))
smoker_q2_bwt = 115
nonsmoker_q2_bwt = 124

aggregate(bwt ~ smoke, df_clean, function(x) quantile(x, 0.75))
smoker_q3_bwt = 126
nonsmoker_q3_bwt = 133

aggregate(bwt ~ smoke, df_clean, sd)
smoker_std_bwt = 16.76733
nonsmoker_std_bwt = 15.15593
```
The mean of nonsmoker bwt is the same as the median of nonsmoker bwt, so the distribution is symmetric. Same with the smoker bwt.


```{r}
boxplot(bwt ~ smoke, data = df_clean,
        main = "Birth Weight Distribution by Smoking Status",
        xlab = "Smoking Status (0 = Non-Smoker, 1 = Smoker)",
        ylab = "Birth Weight",
        col = c("lightblue", "lightpink"),
        border = "darkblue")
```

```{r}

ggplot(df_clean, aes(x = bwt, fill = as.factor(smoke))) +
  geom_density(alpha = 0.5) +
  labs(title = "Density Plot of Birth Weiinght by Smoking Status",
       x = "Birth Weight",
       fill = "Smoking Status (0 = Non-Smoker, 1 = Smoker)") +
  scale_fill_manual(values = c("lightblue", "lightpink"))
```




```{r}
low_bwt_smoker <- sum(df_clean$bwt[df_clean$smoke == 1] < 100) / sum(df_clean$smoke == 1)
low_bwt_smoker = 0.1835749

low_bwt_nonsmoker <- sum(df_clean$bwt[df_clean$smoke == 0] < 100) / sum(df_clean$smoke ==0 )
low_bwt_nonsmoker = 0.05320814
```
If we change the threshold, for example from 100 to 90, then fewer baby would be considered as lower weight, which also reduce the incidence rate. 
If we change the threshold to 105 then more baby would considered as lower wieght, the incidence rate increase.

If the threshold becomes 90, the incidence rate would reduce for both groups. However, the difference between smoker and nonsmoker may become less pronounced. There may be babies that are already lower than 95 from smoker group.

If the threshold becomes 110, the incidence rate would increase for both groups, and the gap of both group would become larger, if smoking is significant 


Numerical Comparison:
Strength: Mean, median, quartile are useful for summarizing central tendancy and variability. It is also easy to compute and interpret large dataset.

Weakness: It would affect by outlier, and ignore the distribution shape. They could have the same median but with different shape spread.


Graphical Comparison:
Strength: Highlights spread and outliers. It allows us to see entire distribution and spread, including skewness and differences in shape.

Weakness: Unlike numerical, we can only see the mean is lower or higher but we do not know the precise number. The perception of differences can change based on how the graph is scaled.


Incidence Comparison:
Strength: It is very direct and easy to interpret. It is valuable for threshold-based decisions in public health or clinical settings.
Weakness: Very sensitive to threshold selection. Changing the cutoff could impact the group comparison. 

